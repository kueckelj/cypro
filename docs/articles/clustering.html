<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering • cypro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Clustering">
<meta property="og:description" content="cypro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cypro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/about.html">About</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/terminology.html">Terminology</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">The cypro object</li>
    <li>
      <a href="../articles/getting-started.html">Experiment design and data loading</a>
    </li>
    <li>
      <a href="../articles/subsetting.html">Create data subsets</a>
    </li>
    <li>
      <a href="../articles/extract-data.html">Extract data and information</a>
    </li>
    <li>
      <a href="../articles/renaming.html">Rename content</a>
    </li>
    <li>
      <a href="../articles/variable-sets.html">Variable sets</a>
    </li>
    <li class="dropdown-header">Analysis &amp; Profiling</li>
    <li>
      <a href="../articles/dim-red.html">Dimensionality reduction</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Correlation</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/plotting-stats.html">Statistical tests and pltos</a>
    </li>
    <li class="dropdown-header">Modules</li>
    <li>
      <a href="../articles/module-migration.html">Migration</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/theMILOlab/cypro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="clustering_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Clustering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/theMILOlab/cypro/blob/master/vignettes/clustering.Rmd" class="external-link"><code>vignettes/clustering.Rmd</code></a></small>
      <div class="hidden name"><code>clustering.Rmd</code></div>

    </div>

    
    
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor" aria-hidden="true"></a>Prerequisites</h2>
<p>Make sure to be familiar with the following tutorials before proceeding:</p>
<ul>
<li><a href="variable-sets.html">Variable Sets</a></li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>1. Introduction</h2>
<p>There are a variety of clustering algorithms. Each of these algorithms comes with its own specific methods and options and metrics such as different distance measures (<em>euclidean</em>, <em>manhattan</em>) or agglomeration methods (<em>complete</em>, <em>ward.D</em>). As clustering is exploratory approach more than one way of clustering cells might be <em>correct</em> or at least provide a satisfying model. <code>cypro</code> currently implements <em>hierarchical</em>, <em>kmeans</em> and <em>partitioning around medoids (PAM)</em>. It does that in a convenient fashion that allows you to iterate over a variety of clustering options for a variety of variable sets and to store all results in the <em>cypro</em> object - ready to be plotted or extracted when needed. This tutorial introduces you to the workflow of all three clustering methods.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">cypro</span><span class="op">)</span>

<span class="co"># load object from broad institute compound profiling experiment week 4</span>
<span class="co"># contains one time imaging data</span>
<span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/bids-week4.RDS"</span><span class="op">)</span></code></pre></div>
</div>
<div id="hierarchical-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#hierarchical-clustering" class="anchor" aria-hidden="true"></a>2. Hierarchical clustering</h2>
<p>Hierarchical clustering is one of the most common algorithms used in exploratory data analysis. It usually contains four steps:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Decide which data variables you want to base the clustering on.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Compute a distance matrix based on the data variables (several distance metrics exist).</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Agglomerate the observations to a hierarchical tree based on the distance matrix (several agglomeration metrics exist).</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Cut the hierarchical tree at a certain height or with a certain predefined value for k.</li>
</ol></li>
</ul>
<p><code>Cypro</code> implements these four steps with four functions.</p>
<div id="initiation" class="section level3">
<h3 class="hasAnchor">
<a href="#initiation" class="anchor" aria-hidden="true"></a>2.1 Initiation</h3>
<p>To initiate hierarchical clustering means to set up the respective S4 object in your <em>cypro</em> object by determining the variables on which you want to base the clustering. This is done with ’cypro’s variable set functionality.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show variables of a previously defined variable set</span>
<span class="fu"><a href="../reference/getVariableSet.html">getVariableSet</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span><span class="op">)</span></code></pre></div>
<details><p><summary>output</summary></p>
<pre><code>##  [1] "Intensity_LowerQuartileIntensity_Actin"
##  [2] "Intensity_MADIntensity_Actin"          
##  [3] "Intensity_MassDisplacement_Actin"      
##  [4] "Intensity_MaxIntensityEdge_Actin"      
##  [5] "Intensity_MaxIntensity_Actin"          
##  [6] "Intensity_MeanIntensityEdge_Actin"     
##  [7] "Intensity_MeanIntensity_Actin"         
##  [8] "Intensity_MedianIntensity_Actin"       
##  [9] "Intensity_MinIntensityEdge_Actin"      
## [10] "Intensity_MinIntensity_Actin"          
## [11] "Intensity_UpperQuartileIntensity_Actin"</code></pre>
</details><p>The function <code><a href="../reference/initiateHierarchicalClustering.html">initiateHierarchicalClustering()</a></code> sets up the necessary object within the <em>cypro</em> object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initiateHierarchicalClustering.html">initiateHierarchicalClustering</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span><span class="op">)</span></code></pre></div>
</div>
<div id="compute-distance-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-distance-matrices" class="anchor" aria-hidden="true"></a>2.2 Compute distance matrices</h3>
<p>To obtain all valid methods with which distance matrices can be computed use <code><a href="../reference/validAgglomerationMethods.html">validDistanceMethods()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/validAgglomerationMethods.html">validDistanceMethods</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "euclidean" "maximum"   "manhattan" "canberra"  "binary"    "minkowski"</code></pre>
<p>While you can specify the distance methods one by one, a more convenient approach would be to tell <code>cypro</code> all distance metrics of interest and then let it do the computation for each one respectively in one function call. Luckily, this is exactly what makes <code>cypro</code> so convenient.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distance_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"manhattan"</span><span class="op">)</span>

<span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeDistanceMatrices.html">computeDistanceMatrices</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, method_dist <span class="op">=</span> <span class="va">distance_methods</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="agglomerate-hierarchical-cluster" class="section level2">
<h2 class="hasAnchor">
<a href="#agglomerate-hierarchical-cluster" class="anchor" aria-hidden="true"></a>2.3 Agglomerate hierarchical cluster</h2>
<p>There are a variety of methods to agglomerate distance measures to hierarchical tree. Again you can specify all approaches you would like to explore in one simple function call. Use <code><a href="../reference/validAgglomerationMethods.html">validAgglomerationMethods()</a></code> to obtain valid input options for argument <code>method_aggl</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/validAgglomerationMethods.html">validAgglomerationMethods</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "ward.D"   "ward.D2"  "single"   "complete" "average"  "mcquitty" "median"  
## [8] "centroid"</code></pre>
<p>Specifying two different input options makes <code><a href="../reference/agglomerateHierarchicalCluster.html">agglomerateHierarchicalCluster()</a></code> use every unique combination automatically.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aggl_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"complete"</span>, <span class="st">"ward.D"</span><span class="op">)</span>

<span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agglomerateHierarchicalCluster.html">agglomerateHierarchicalCluster</a></span><span class="op">(</span><span class="va">object</span>,
                                         variable_set <span class="op">=</span> <span class="st">"intensity"</span>,
                                         method_dist <span class="op">=</span> <span class="va">distance_methods</span>, 
                                         method_aggl <span class="op">=</span> <span class="va">aggl_methods</span><span class="op">)</span></code></pre></div>
<p>The function <code><a href="../reference/plotDendrogram.html">plotDendrogram()</a></code> allows to visualize cluster agglomeration with a variety of options. Check out its documentation with <code><a href="../reference/plotDendrogram.html">?plotDendrogram</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotDendrogram.html">plotDendrogram</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, method_dist <span class="op">=</span> <span class="st">"euclidean"</span>, method_aggl <span class="op">=</span> <span class="st">"ward.D"</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="clustering_files/figure-html/plot%20dendrogram-1.png" alt="Figure 1.1 Dendrogram visualizing one of the distance-agglomeration options" width="100%"><p class="caption">
Figure 1.1 Dendrogram visualizing one of the distance-agglomeration options
</p>
</div>
<div id="adding-hierarchical-cluster-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-hierarchical-cluster-variables" class="anchor" aria-hidden="true"></a>2.4 Adding hierarchical cluster variables</h3>
<p>To make interesting clustering results available for subsequent analysis steps they must be added in form of grouping variables to the <a href="extract_data.html#Cluster%20data.frame">cluster data</a>. If no variables have been added the data.frame is empty.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># no clustering variables have been added yet</span>
<span class="fu"><a href="../reference/getGroupingVariableNames.html">getClusterVariableNames</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></code></pre></div>
<pre><code>## No cluster variables have been calculated yet.</code></pre>
<pre><code>## character(0)</code></pre>
<p>Adding clustering variables can be done conveniently via <code><a href="../reference/addHierarchicalClusterVariables.html">addHierarchicalClusterVariables()</a></code>. Specify distance methods, agglomeration methods and all ways according to which you want to cut the trees. All valid combinations are added to the cell cluster data and are made available for arguments like <code>across</code> or <code>grouping_variable</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addHierarchicalClusterVariables.html">addHierarchicalClusterVariables</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, 
                                          method_dist <span class="op">=</span> <span class="st">"euclidean"</span>, 
                                          method_aggl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"complete"</span>, <span class="st">"ward.D"</span><span class="op">)</span>, 
                                          k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>
                                          <span class="op">)</span>

<span class="fu"><a href="../reference/getGroupingVariableNames.html">getClusterVariableNames</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "hcl_euclidean_complete_k_3_(intensity)"
## [2] "hcl_euclidean_complete_k_4_(intensity)"
## [3] "hcl_euclidean_complete_k_5_(intensity)"
## [4] "hcl_euclidean_ward.D_k_3_(intensity)"  
## [5] "hcl_euclidean_ward.D_k_4_(intensity)"  
## [6] "hcl_euclidean_ward.D_k_5_(intensity)"</code></pre>
</div>
<div id="a-note-on-handling-distance-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#a-note-on-handling-distance-matrices" class="anchor" aria-hidden="true"></a>2.5 A note on handling distance matrices</h3>
<p>Distance matrices can become very big in size. The convenient iteration that <code>cypro</code> allows comes with a drawback: The <em>cypro</em> object grows in size pretty quick, too.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html" class="external-link">object_size</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></code></pre></div>
<pre><code>## 1.41 GB</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hclust_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getHclustConv.html">getHclustConv</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span><span class="op">)</span>

<span class="va">euclidean_dist_mtr</span> <span class="op">&lt;-</span> <span class="va">hclust_conv</span><span class="op">@</span><span class="va">dist_matrices</span><span class="op">$</span><span class="va">euclidean</span>

<span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html" class="external-link">object_size</a></span><span class="op">(</span><span class="va">euclidean_dist_mtr</span><span class="op">)</span></code></pre></div>
<pre><code>## 677 MB</code></pre>
<p>Fortunately, the computation of distance matrices and the agglomeration of hierarchical cluster are separated processes. Once cluster have been aggregated based on a distance matrix, the latter is not needed any longer. You can therefore discard them, even before adding the cluster variables to the cell data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discardDistanceMatrix.html">discardDistanceMatrix</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, method_dist <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span>

<span class="va">hclust_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getHclustConv.html">getHclustConv</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span><span class="op">)</span>

<span class="co"># does not exist any longer ( == NULL)</span>
<span class="va">hclust_conv</span><span class="op">@</span><span class="va">dist_matrices</span><span class="op">$</span><span class="va">euclidean</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cypro object is way smaller </span>
<span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html" class="external-link">object_size</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></code></pre></div>
<pre><code>## 738 MB</code></pre>
<p>We recommend to regularly check the size of the <em>cypro</em> object with <code><a href="https://rdrr.io/pkg/pryr/man/object_size.html" class="external-link">pryr::object_size()</a></code> and to discard unneeded distance matrices. In case you realize after discarding that you need it again you can always compute it again via <code><a href="../reference/computeDistanceMatrices.html">computeDistanceMatrices()</a></code> without initiating a new hierarchical clustering for the variable set of interest!</p>
</div>
</div>
<div id="kmeans-clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#kmeans-clustering" class="anchor" aria-hidden="true"></a>3. Kmeans clustering</h2>
<p>Kmeans clustering can be conducted in a similar fashion.</p>
<div id="initiatiation" class="section level3">
<h3 class="hasAnchor">
<a href="#initiatiation" class="anchor" aria-hidden="true"></a>3.1 Initiatiation</h3>
<p>To initiate kmeans clustering based on a new variable set use <code><a href="../reference/initiateHierarchicalClustering.html">initiateKmeansClustering()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initiateHierarchicalClustering.html">initiateKmeansClustering</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span><span class="op">)</span></code></pre></div>
</div>
<div id="cluster-computation" class="section level3">
<h3 class="hasAnchor">
<a href="#cluster-computation" class="anchor" aria-hidden="true"></a>3.2 Cluster computation</h3>
<p><code><a href="../reference/validAgglomerationMethods.html">validKmeansMethods()</a></code> provides all valid kmeans methods.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/validAgglomerationMethods.html">validKmeansMethods</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Hartigan-Wong" "Lloyd"         "Forgy"         "MacQueen"</code></pre>
<p>The function <code><a href="../reference/computeKmeansCluster.html">computeKmeansCluster()</a></code> iterates over all valid input combinations for arguments <code>k</code> and <code>method_kmeans</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmeans_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hartigan-Wong"</span>, <span class="st">"Lloyd"</span><span class="op">)</span>

<span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeKmeansCluster.html">computeKmeansCluster</a></span><span class="op">(</span><span class="va">object</span>,
                               variable_set <span class="op">=</span> <span class="st">"intensity"</span>,
                               k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, <span class="co"># compute clustering for values k = 2, k = 3, ... k = 10</span>
                               method_kmeans <span class="op">=</span> <span class="va">kmeans_methods</span><span class="op">)</span></code></pre></div>
<p>To assess clustering quality and optimal inputs for <code>k</code> use <code><a href="../reference/plotScreeplot.html">plotScreeplot()</a></code>. Based on it’s output you can decide with which clustering results you want to proceed.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotScreeplot.html">plotScreeplot</a></span><span class="op">(</span><span class="va">object</span>,
              variable_set <span class="op">=</span> <span class="st">"intensity"</span>, 
              k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, 
              method_kmeans <span class="op">=</span> <span class="va">kmeans_methods</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="clustering_files/figure-html/kmeans-screeplot-1.png" alt="Figure 3.1 Screeplots can be used to determine optimal value for k" width="100%"><p class="caption">
Figure 3.1 Screeplots can be used to determine optimal value for k
</p>
</div>
</div>
<div id="adding-kmeans-cluster-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-kmeans-cluster-variables" class="anchor" aria-hidden="true"></a>3.4 Adding kmeans cluster variables</h3>
<p>To make clustering results available for subsequent functions use <code>addKmeansClusteringVariables()</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addKmeansClusterVariables.html">addKmeansClusterVariables</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, method_kmeans <span class="op">=</span> <span class="st">"Lloyd"</span><span class="op">)</span>

<span class="fu"><a href="../reference/getGroupingVariableNames.html">getClusterVariableNames</a></span><span class="op">(</span><span class="va">object</span>, <span class="fu"><a href="../reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"kmeans"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "kmeans_Lloyd_k_3_(intensity)" "kmeans_Lloyd_k_4_(intensity)"
## [3] "kmeans_Lloyd_k_5_(intensity)"</code></pre>
</div>
</div>
<div id="partitioning-around-medoids-pam" class="section level2">
<h2 class="hasAnchor">
<a href="#partitioning-around-medoids-pam" class="anchor" aria-hidden="true"></a>4. Partitioning around medoids (PAM)</h2>
<p>The PAM algorigthm works very similar to kmeans although it is a bit more robust and comes with an additional metric, <em>silhouette width</em>, to assess cluster quality. A major drawback of this algorithm is, that it is way slower than kmeans. A recommended approach is to conduct kmeans clustering first to narrow down the values for argument <code>k</code> that come into question. Apart from that the PAM clustering workflow is equal to the one of kmeans.</p>
<div id="initiate-pam-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#initiate-pam-clustering" class="anchor" aria-hidden="true"></a>4.1 Initiate PAM clustering</h3>
<p>Use the function <code><a href="../reference/initiateHierarchicalClustering.html">initiatePamClustering()</a></code> to set up the analysis pipeline.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initiateHierarchicalClustering.html">initiatePamClustering</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span><span class="op">)</span></code></pre></div>
</div>
<div id="run-the-algorithm" class="section level3">
<h3 class="hasAnchor">
<a href="#run-the-algorithm" class="anchor" aria-hidden="true"></a>4.2 Run the algorithm</h3>
<p>… with function <code><a href="../reference/computePamCluster.html">computePamCluster()</a></code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePamCluster.html">computePamCluster</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>Partitioning around medoids comes with some plotting options to assess cluster quality such as the average silhouette width…</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotAvgSilhouetteWidths.html">plotAvgSilhouetteWidths</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="clustering_files/figure-html/plot-avg-sil-width-1.png" alt="Figure 4.1 Average silhouette width plot." width="100%"><p class="caption">
Figure 4.1 Average silhouette width plot.
</p>
</div>
<p>… and the silhouette widths for every observation.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotAvgSilhouetteWidths.html">plotSilhouetteWidths</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="clustering_files/figure-html/plot-sil-width-1.png" alt="Figure 4.2 Silhouette width plot." width="100%"><p class="caption">
Figure 4.2 Silhouette width plot.
</p>
</div>
</div>
<div id="add-pam-cluster-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#add-pam-cluster-variables" class="anchor" aria-hidden="true"></a>4.3 Add PAM cluster variables</h3>
<p>Add the cluster variables of interest via <code><a href="../reference/addPamClusterVariables.html">addPamClusterVariables()</a></code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addPamClusterVariables.html">addPamClusterVariables</a></span><span class="op">(</span><span class="va">object</span>, variable_set <span class="op">=</span> <span class="st">"intensity"</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/getGroupingVariableNames.html">getClusterVariableNames</a></span><span class="op">(</span><span class="va">object</span>, <span class="fu"><a href="../reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"pam"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "pam_euclidean_k_4_(intensity)" "pam_euclidean_k_5_(intensity)"</code></pre>
</div>
</div>
<div id="renaming-cluster-variables-and-cluster-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#renaming-cluster-variables-and-cluster-groups" class="anchor" aria-hidden="true"></a>Renaming cluster variables and cluster groups</h2>
<p>To ensure unambiguous naming with respect to algorithm, variable set, methods etc. the initial clustering names are somewhat bulky. In addition to that are cluster named by number which is barely informative. In case you want to rename cluster variables or single cluster groups of a variable have a look at the tutorial about how to <a href="rename-content.html">rename content</a> in <code>cypro</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
