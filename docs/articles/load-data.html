<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Loading • cypro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data Loading">
<meta property="og:description" content="cypro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cypro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/about.html">About</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/terminology.html">Terminology</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/design-experiment.html">1. Experiment design</a>
    </li>
    <li>
      <a href="../articles/load-data.html">2. Data loading</a>
    </li>
    <li>
      <a href="../articles/process-data.html">3. Data processing</a>
    </li>
    <li class="dropdown-header">Quality checks</li>
    <li>
      <a href="../articles/outlier-detection.html">Outlier detection</a>
    </li>
    <li class="dropdown-header">Around the cypro object</li>
    <li>
      <a href="../articles/default-setting.html">Default setting</a>
    </li>
    <li>
      <a href="../articles/subsetting.html">Create data subsets</a>
    </li>
    <li>
      <a href="../articles/extract-data.html">Extract data and information</a>
    </li>
    <li>
      <a href="../articles/adding.html">Add content</a>
    </li>
    <li>
      <a href="../articles/renaming.html">Rename content</a>
    </li>
    <li>
      <a href="../articles/variable-sets.html">Variable sets</a>
    </li>
    <li class="dropdown-header">Cell Profiling</li>
    <li>
      <a href="../articles/dim-red.html">Dimensionality reduction</a>
    </li>
    <li>
      <a href="../articles/correlation.html">Correlation</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li class="dropdown-header">Analysis Modules</li>
    <li>
      <a href="../articles/module-migration.html">Migration</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-stats.html">Statistical tests and plots</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/theMILOlab/cypro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="load-data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data Loading</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/theMILOlab/cypro/blob/master/vignettes/load-data.Rmd" class="external-link"><code>vignettes/load-data.Rmd</code></a></small>
      <div class="hidden name"><code>load-data.Rmd</code></div>

    </div>

    
    
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor" aria-hidden="true"></a>Prerequisites</h2>
<p>Make sure to be familiar with the following tutorials before proceeding:</p>
<ul>
<li><a href="extract-data.html">Terminology</a></li>
<li><a href="design-experiment.html">Experiment Design</a></li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>1. Introduction</h2>
<p>After the use of <code><a href="../reference/designExperiment.html">designExperiment()</a></code> the experiment design is now stored in the <em>cypro</em>-object called <code>cypro_object_new</code>. You can’t do any analysis and visualization with it yet as it does not contain any loaded data. To load data use the <code>loadData*()</code>- functions. There are two of them.</p>
<ul>
<li><p><code><a href="../reference/loadDataFile.html">loadDataFile()</a></code> is needed if the data is already present in one single file. This is often the case if <em>CellProfiler</em> has been used as the image processing software. This data table must contain variables giving information about the well, the region of interest (ROI) and - if the experiment design contains more than one well plate - about the well plate.</p></li>
<li><p><code><a href="../reference/loadDataFile.html">loadDataFiles()</a></code> is needed if the data is present in multiple files. This is the case if <em>CellTracker</em> has been used as the image processing software. In this case the information about the well-ROI and the well plate is conveyed by the names of the file (see below for more information).</p></li>
</ul>
</div>
<div id="load-multiple-files" class="section level2">
<h2 class="hasAnchor">
<a href="#load-multiple-files" class="anchor" aria-hidden="true"></a>2. Load multiple files</h2>
<p><code><a href="../reference/loadDataFile.html">loadDataFiles()</a></code> again opens a user interface. It is split in two parts.</p>
<div id="prepare-data-loading" class="section level3">
<h3 class="hasAnchor">
<a href="#prepare-data-loading" class="anchor" aria-hidden="true"></a>2.1 Prepare data loading</h3>
<p>The <code>cypro</code> package is very flexible regarding its input data. This flexibility comes with a small price: The name of important data variables such as x-coordinates, y-coordinates, Cell ID etc. must be single handedly denoted one by one. This is done during step 1 <em>Prepare data loading</em>.</p>
<div id="load-template-file" class="section level4">
<h4 class="hasAnchor">
<a href="#load-template-file" class="anchor" aria-hidden="true"></a>2.2.1 Load template file</h4>
<p>Here you upload an example file that is representative of all the other files that you will read in later on. Once the file is loaded you see the first six rows printed right below.</p>
<div class="figure">
<img src="images/load-data/load-example.PNG" alt="Figure 1 Load an example file." width="100%"><img src="images/load-data/example-loaded.PNG" alt="Figure 1 Load an example file." width="100%"><p class="caption">
Figure 1 Load an example file.
</p>
</div>
<p>The example file in this case is a <em>track file</em> derived from the image processing software Cell Tracker.</p>
</div>
<div id="denote-identifier-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#denote-identifier-variables" class="anchor" aria-hidden="true"></a>2.2.2 Denote identifier variables</h4>
<p>As explained in the terminology article <code>cypro</code>requires its input data to contain data variables that contain information about the cell id and the frame. In case of data files generated with <em>CellTracker</em> the variable names are obvious but they might change from software to software.</p>
<div class="figure">
<img src="images/load-data/identifier-variables.PNG" alt="Figure 2 Tell cypro which columns refer to the cell id and the frame." width="100%"><p class="caption">
Figure 2 Tell cypro which columns refer to the cell id and the frame.
</p>
</div>
</div>
<div id="denote-module-specific-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#denote-module-specific-variables" class="anchor" aria-hidden="true"></a>2.2.3 Denote module specific variables</h4>
<p>Beyond the convenient possibility to read in huge amount of files according to specific experiment designs <code>cypro</code> offers a variety of analysis functionalities. <em>Step 3: Denote module specific variables</em> is about telling cypro where to get the required information as well as which modules it is supposed to use. Some of them require specific data variables (needed variables) based on which other variables are computed (computable variables). Every select input option is provided with a blue question mark which displays information about the variable to be denoted.</p>
<div class="figure">
<img src="images/load-data/cell-id-variable.PNG" alt="Figure 3 Example variable descriptions." width="50%" height="50%"><img src="images/load-data/x-coords-variable.PNG" alt="Figure 3 Example variable descriptions." width="50%" height="50%"><img src="images/load-data/speed-variable.PNG" alt="Figure 3 Example variable descriptions." width="50%" height="50%"><img src="images/load-data/parent-id.PNG" alt="Figure 3 Example variable descriptions." width="50%" height="50%"><p class="caption">
Figure 3 Example variable descriptions.
</p>
</div>
<p>For instance, the migration module needs information about x- and y-coordinates. If not specified additionally data variables such as <em>Distance from origin</em> or <em>Instantaneous speed</em> can be computed. While basically every image processing software outputs x- and y-coordinates of the tracked cells information about cell splits are not part of every software output. If your data files do not contain needed variables for a certain module make sure to ‘turn off’ the module with the slider below it. In this case the CellTracker files do not contain mitosis related data. Therefore we won’t be able to use the mitosis module.</p>
<div class="figure">
<img src="images/load-data/module-variables.PNG" alt="Figure 4 Tell cypro where to look for needed information." width="100%"><p class="caption">
Figure 4 Tell cypro where to look for needed information.
</p>
</div>
</div>
<div id="denote-additional-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#denote-additional-variables" class="anchor" aria-hidden="true"></a>2.2.4 Denote additional variables</h4>
<p>Every additional data variable that is unknown to <code>cypro</code> but contains information you want to include in downstream analysis steps such as clustering and correlation can be denoted here. CellTracker does not offer any additional variables apart from those already integrated in our migration module.</p>
<div class="figure">
<img src="images/load-data/additional-variables.PNG" alt="Figure 5 No data variables remain to be selected additionally." width="100%"><p class="caption">
Figure 5 No data variables remain to be selected additionally.
</p>
</div>
<p>In case of output files from <a href="">CellProfiler</a> it could look somewhat like this.</p>
<div class="figure">
<img src="images/load-data/numeric-variables.PNG" alt="Figure 6 Tell cypro which addtional variables you want to analyze later on." width="100%"><p class="caption">
Figure 6 Tell cypro which addtional variables you want to analyze later on.
</p>
</div>
<p>Note: Data variables denoted in <em>Step 3 Denote module variables</em> can be used for correlation and clustering, too! <em>Step 4 Denote additional variables</em> simply lets you keep data variables that do not have an inherent meaning to <code>cypro</code> while simultaneously lets you discard variables you won’t be interested in later on.</p>
</div>
</div>
<div id="last-check" class="section level3">
<h3 class="hasAnchor">
<a href="#last-check" class="anchor" aria-hidden="true"></a>2.2.5 Last check</h3>
<p>Every denoted variable name is saved as such. Based on the input from step 2, step 3, and step 4 the final data.frame as shown in Figure 7 is what <code>cypro</code> expects all files you are about to read in to look like. (The order of the data variables does not matter. However, missing data variables will result in an error during the reading process. See below.)</p>
<div class="figure">
<img src="images/load-data/final-data-output.PNG" alt="Figure 7 Double check that the data.frame cypro expects contains all information you need later on." width="100%"><p class="caption">
Figure 7 Double check that the data.frame cypro expects contains all information you need later on.
</p>
</div>
</div>
</div>
<div id="load-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data" class="anchor" aria-hidden="true"></a>2.3 Load data</h2>
<p>Once <code>cypro</code> knows what to expect you assign a folder to each well plate that you’ve previously designed in <code><a href="../reference/designExperiment.html">designExperiment()</a></code>. <code>cypro</code> will then skim the folder and all its subfolders for data files that match the well-image names.</p>
<div class="figure">
<img src="images/load-data/assign-folders.PNG" alt="Figure 8 No folders have been assigned yet." width="100%"><p class="caption">
Figure 8 No folders have been assigned yet.
</p>
</div>
<p>It takes the folder (here represented by ‘~/’) you’ve chosen and skims its content for files that end according to the following syntax:</p>
<ul>
<li>~/<em>…</em>’Well’_‘ImageIndex’.’filetype’</li>
</ul>
<p>Valid examples would be:</p>
<ul>
<li>~/A1_1.xls</li>
<li>~/this_is_a_valid_filename_G3_2.xlsx</li>
<li>~/hidden/in/subfolders/H2_2.csv</li>
</ul>
<p>Invalid examples:</p>
<ul>
<li>~/A1-1.csv (does not use _ as a separator between well and image)</li>
<li>~/does_not_end_A1_1_accordingly.xls (the file name does not end with the well-image pattern)</li>
</ul>
<div class="figure">
<img src="images/load-data/assign-folders-example-invalid.PNG" alt="Figure 9 Pick the main folder that contains the data files of the respective well plate." width="50%"><img src="images/load-data/assign-folders-example.PNG" alt="Figure 9 Pick the main folder that contains the data files of the respective well plate." width="50%"><p class="caption">
Figure 9 Pick the main folder that contains the data files of the respective well plate.
</p>
</div>
<p>Note: Although the actual files are stored in subfolders choosing the folder <em>TMZ_and_LY</em> as the folder that contains all files for the respective well plate is the way to go as <code>cypro</code> looks into the subfolders as well.</p>
<p>Once the folder is assigned <code>cypro</code> evaluates by well how many of the expected files were found and indicates that by plotting the well plate colored according to the file availability (Figure 10).</p>
<p>For instance, the well plate designed <a href="design-experiment.html">here</a> contained information for wells in rows A, D, E and H and columns 1-9. The input box ‘Images per Well’ was set to 3. <code>cypro</code> therefore expects to find three files for every well named according to the syntax mentioned above. Depending on the number of matching files found one of the four colors appears:</p>
<ul>
<li><p>Green: All files were found for that well.</p></li>
<li><p>Yellow: Some files were found for that well.</p></li>
<li><p>Red: No files were found for that well.</p></li>
<li><p>Blue: More than the expected number of files were found. This can happen if files are stored in subfolders and accidentally were named equally.</p></li>
</ul>
<p>For instance files ~/subfolder1/A1_1.csv and ~/subfolder2/A1_1.csv would result in well A1 appearing blue.</p>
<p>Note: Figure 9 shows the content of folder ~/168/Ctrl/. It contains several files with the well-image pattern <em>A4_2</em>. However, only one of the file names is valid which is why the evaluation plot in Figure 10 does not indicate that there are any ambiguous files. On the other hand there are several files that end with the well image pattern <em>A5_1</em>. Although the files are prefixed differently <code>cypro</code> does not recognize the difference as it considers all files that end with a well-image pattern as valid. The input for well image A5_1 is ambiguous. Ambiguous files need to be either removed or renamed.</p>
<div class="figure">
<img src="images/load-data/evaluation-plot.PNG" alt="Figure 10 Wells that were dismissid in designExperiment() are ignored and always displayd in grey." width="100%"><p class="caption">
Figure 10 Wells that were dismissid in designExperiment() are ignored and always displayd in grey.
</p>
</div>
<p>In case of missing files the well plate plotted could look like this. (A well plate from a different experiment design.)</p>
<div class="figure">
<img src="images/load-data/missing-files.PNG" alt="Figure 11 If no files were found the wells are displayed in red." width="100%"><p class="caption">
Figure 11 If no files were found the wells are displayed in red.
</p>
</div>
<p>Missing and incomplete wells do not prevent you from loading the data. If you realize that some files are missing, check for possible naming issues, correct what needs to be corrected and then assign the folder again. The file availability is reevaluated and colors should change accordingly. Once all well plates have a folder assigned to them and no ambiguous files were found the box ‘Well Plate Status’ turns green indicating that the data is ready to be loaded.</p>
<div class="figure">
<img src="images/load-data/well-plate-status.PNG" alt="Figure 12 A green 'Well Plate Status' box indicates that the data files are ready to be loaded." width="100%"><p class="caption">
Figure 12 A green ‘Well Plate Status’ box indicates that the data files are ready to be loaded.
</p>
</div>
<p>After clicking on ‘Load Data’ a progress bar is going to appear in the lower right corner indicating the loading progress. While being loaded all files are checked to match the requirements set up during the variable denotation. If any errors occur during the loading process they are presented in the box ‘Load Files &amp; Proceed’ in combination with the error message returned.</p>
<div class="figure">
<img src="images/load-data/save-and-proceed.PNG" alt="Figure 13 If errors occured while loading some files they are listed here." width="100%"><p class="caption">
Figure 13 If errors occured while loading some files they are listed here.
</p>
</div>
<p>Again, you can choose to ignore failed files and simply proceed without them by clicking on ‘Save &amp; Proceed’ and then on ‘Return Cypro Object’. If possible you can fix the reason that prevented <code>cypro</code> from reading the file successfully and click on ‘Load Data’ again.</p>
</div>
<div id="load-one-file" class="section level2">
<h2 class="hasAnchor">
<a href="#load-one-file" class="anchor" aria-hidden="true"></a>3. Load one file</h2>
<p>The way <code><a href="../reference/loadDataFile.html">loadDataFile()</a></code> works is very similar to the way <code><a href="../reference/loadDataFile.html">loadDataFiles()</a></code> works. There are two differences:</p>
<ol style="list-style-type: decimal">
<li><p>Instead of uploading a template file you immediately upload the file that contains all the data.</p></li>
<li><p>Before denoting the module specific variables you need to denote the ones that contain the information about the well plate, well and ROI.</p></li>
</ol>
<div class="figure">
<img src="images/load-data/loadDataFiles-experiment-vars.PNG" alt="Figure 14 The interface of `loadDataFile()` looks slightly different." width="100%"><p class="caption">
Figure 14 The interface of <code><a href="../reference/loadDataFile.html">loadDataFile()</a></code> looks slightly different.
</p>
</div>
<p>These <em>experiment design</em> variables are then checked for validity. If they can be used to match the data to the experiment design you can proceed with denoting the module specific variables as described above and eventually return the <code>cypro</code>-object that now contains the data.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
